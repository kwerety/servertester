<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Server Status</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <div class="theme-toggle">
    <button id="theme-switch" class="button">
      <span id="theme-icon">üåû</span> Switch to Dark Theme
    </button>
  </div>

  <div class="container">
    <h1>Server Status</h1>
    <div class="switch">
      <input type="checkbox" id="toggle-switch" {{ 'disabled' if not admin_logged_in else '' }}>
      <label for="toggle-switch" class="slider"></label>
    </div>
    <p id="status-text">Status: Loading...</p>
    
    <div id="admin-panel" class="admin-panel" {{ 'style="display:none;"' if admin_logged_in else '' }}>
      <h2>Admin Panel</h2>
      <input type="password" id="admin-password" placeholder="Enter Admin Password">
      <button class="button" onclick="loginAdmin()">Login</button>
      <p id="error-msg" style="display:none;">Invalid password, try again.</p>
    </div>
    
    <button id="admin-btn" class="button" onclick="openAdmin()" {{ 'style="display:none;"' if admin_logged_in else '' }}>Admin Login</button>
  </div>
  
  <div class="downloads">
  <button class="download-button" onclick="downloadFile('file1.zip')">
    <span>Download File 1</span>
  </button>
  <button class="download-button" onclick="downloadFile('file2.zip')">
    <span>Download File 2</span>
  </button>
  <button class="download-button" onclick="downloadFile('file3.zip')">
    <span>Download File 3</span>
  </button>
</div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.0/socket.io.min.js"></script>
  <script src="{{ url_for('static', filename='Script.js') }}"></script>

  <script>
    const socket = io();

    // –ü–æ–ª—É—á–∞–µ–º —Å—Ç–∞—Ç—É—Å —Å —Å–µ—Ä–≤–µ—Ä–∞ –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏
    socket.on('status_updated', function(data) {
      const status = data.status;
      document.getElementById("toggle-switch").checked = status;
      document.getElementById("status-text").innerText = `Status: ${status ? "ON" : "OFF"}`;
    });

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—è
    document.getElementById("toggle-switch").addEventListener("change", function () {
      const status = this.checked;
      fetch('/status', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ status: status })
      });
    });

    // –õ–æ–≥–∏–Ω –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
    function loginAdmin() {
      const password = document.getElementById("admin-password").value;
      fetch('/login', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ password: password })
      })
      .then(response => response.json())
      .then(data => {
        if (data.success) {
          // –°–∫—Ä—ã–≤–∞–µ–º –ø–∞–Ω–µ–ª—å –≤—Ö–æ–¥–∞ –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—è
          document.getElementById("admin-panel").style.display = "none";
          document.getElementById("admin-btn").style.display = "none";
          document.getElementById("toggle-switch").disabled = false;
        } else {
          // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –æ—à–∏–±–∫—É
          document.getElementById("error-msg").style.display = "block";
        }
      });
    }
  </script>
</body>
</html>
